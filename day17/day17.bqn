mâ€¿nâ†â‰¢gridâ†'0'-Ëœ>â€¢FLines"input"

dirsâ†âˆ¾âŸœ-â‹ˆâŸœâŒ½0â€¿1
Inboundsâ†âˆ§Â´(0â€¿0âŠ¸â‰¤âˆ§<âŸœmâ€¿n)
Stepâ†{aâ€¿bğ•Šqâ€¿vâ€¿dists:
  uâ†2â†‘âŠ‘q
  dâ†{ğ•Š0â€¿0â€¿0: 9â€¿9 ; (2âŠ‘ğ•©)âŠ‘dirs}âŠ‘q
  nsâ†(InboundsÂ¨âŠ‘âˆ˜âŒ½Â¨)âŠ¸/ uâŠ¸+Â¨Â¨âˆ¾{ğ•©âŠ¸Ã—Â¨Â¨(â†‘âŸœ(1+â†•b)Â¨a+â†•1+b-a)}Â¨dirs
  nsâ†©((|d)âŠ¸â‰¢Â¨|-âŸœuÂ¨âŠ‘Â¨ns)/ns
  nsâ†©nsâˆ¾Â¨Â¨âŠ‘Â¨(dirsâŠ<)Â¨uâŠ¸-ËœÂ¨âŠ‘Â¨ns
  nsâ†©(Â¬(âŠ‘âˆ˜âŒ½Â¨ns)âŠ‘v)/ns
  newdistsâ†dists âŒŠ (((âŠ‘q)âŠ‘dists)++Â´Â¨âŠ‘âŸœgridÂ¨2âŠ¸â†‘Â¨Â¨ns)âŒ¾((âŠ‘âˆ˜âŒ½Â¨ns)âŠ¸âŠ‘)dists
  changednsâ†((âŠ‘âŸœnewdists<âŠ‘âŸœdists)Â¨âŠ‘âˆ˜âŒ½Â¨ns) / ns
  newqâ†(â‹âŠ‘âŸœnewdists)âŠ¸âŠ (âŠ‘âˆ˜âŒ½Â¨changedns)âˆ¾1â†“q
  newvâ†1âŒ¾((âŠ‘q)âŠ¸âŠ‘)v
  newqâ€¿newvâ€¿newdists
}
Targetâ†âŒŠÂ´ ((n-1)âŠ¸âŠ (m-1)âŠ¸âŠ) #(mâ€¿n-1)âŠ‘âŒŠËâ‰1

qâ†âŸ¨0â€¿0â€¿0âŸ©
vâ†mâ€¿nâ€¿4â¥Š0
ubâ†1e4
distsâ†0Ë™Â¨âŒ¾((0â€¿0âŠ¸âˆ¾Â¨â†•4)âŠ¸âŠ‘) mâ€¿nâ€¿4â¥Šub
Â·â€¿Â·â€¿d1â†1â€¿3 Stepâ€¢_while_{ub=Target 2âŠ‘ğ•©} qâ€¿vâ€¿dists
â€¢Show Target d1

Â·â€¿Â·â€¿d2â†4â€¿10 Stepâ€¢_while_{ub=Target 2âŠ‘ğ•©} qâ€¿vâ€¿dists
â€¢Show Target d2

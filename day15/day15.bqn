âŸ¨SplitâŸ©â†â€¢Import"../bqn-libs/strings.bqn"
â‰ inputâ†","SplitâŠ‘â€¢FLines"input"

Hâ†(âŠ‘âŒ½)0(256|17Ã—+)`-âŸœ@

â€¢Show +Â´HÂ¨input

Parseâ†{
  âŠ‘'='âˆŠğ•© ? â€¢ParseFloatâŒ¾(1âŠ¸âŠ‘)'='Splitğ•© ;
  âŠ‘'-'âˆŠğ•© ? 1â†‘'-'Splitğ•©
}

Replaceâ†{tâ€¿nğ•Šğ•©:
  âŠ‘(<t)âˆŠâŠ‘Â¨ğ•© ? iâ†âŠ‘/((<t)â‰¡Â¨âŠ‘Â¨)ğ•© â‹„ tâ€¿nË™âŒ¾(iâŠ¸âŠ‘)ğ•© ;
  ğ•©âˆ¾âŸ¨ğ•¨âŸ©
}

Runâ†{
  boxesâ†256â¥ŠâŸ¨âŸ¨âŸ©âŸ©
  Stepâ†{
    ğ•ŠâŸ¨tâŸ©: boxes (((<t)â‰¢Â¨âŠ‘Â¨)âŠ¸/)âŒ¾((H t)âŠ¸âŠ‘)â†© ;
    ğ•Štâ€¿n: boxes (tâ€¿nâŠ¸Replace)âŒ¾((H t)âŠ¸âŠ‘)â†©
  }
  StepÂ¨ğ•©
  boxes
}

Powâ†+Â´(1+(â†•â‰ ))âŠ¸Ã—
â€¢Show Pow PowÂ¨ 1âŠ¸âŠ‘Â¨Â¨ Run ParseÂ¨ input

gridâ†>â€¢FLines"input"

Simâ†{
  Stepâ†{ğ•Švâ€¿nv:
    nextsâ†{âˆ§Â´(0âŠ¸â‰¤âˆ§<âŸœ(â‰¢grid))âŠ‘ğ•©}Â¨âŠ¸/âˆ¾{ğ•Špâ€¿d:
      {
	ğ•Š'.'â€¿Â·: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'/'â€¿Â·: âŸ¨âŸ¨p-âŒ½d,-âŒ½dâŸ©âŸ© ;
	ğ•Š'\'â€¿Â·: âŸ¨âŸ¨p+âŒ½d,âŒ½dâŸ©âŸ© ;
	ğ•Š'|'â€¿1: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'|'â€¿0: âŸ¨âŸ¨p+1â€¿0,1â€¿0âŸ©,âŸ¨p-1â€¿0,-1â€¿0âŸ©âŸ© ;
	ğ•Š'-'â€¿0: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'-'â€¿1: âŸ¨âŸ¨p+0â€¿1,0â€¿1âŸ©,âŸ¨p-0â€¿1,-0â€¿1âŸ©âŸ©
      }âŸ¨pâŠ‘grid,|âŠ‘dâŸ©
    }Â¨nv
    âŸ¨nvâˆ¾v,(Â¬nextsâˆŠv)/nextsâŸ©
  }
  âŠ‘Stepâ€¢_while_{0â‰ â‰ 1âŠ‘ğ•©} âŸ¨âŸ©â€¿âŸ¨ğ•©âŸ©
}

â€¢Show â‰ â·âŠ‘Â¨SimâŸ¨0â€¿0,0â€¿1âŸ©

# vâ†SimâŸ¨0â€¿0,0â€¿1âŸ©
# â€¢Out â¥Šâˆ¾âŸœ(@+10)Ë˜'â–ˆ'Ë™Â¨âŒ¾((âŠ‘Â¨v)âŠ¸âŠ‘) (â‰¢grid)â¥Š' '

mâ€¿nâ†â‰¢grid
startsâ†(â‹ˆâŸœ1â€¿0Â¨0âŠ¸âˆ¾Â¨â†•m)âˆ¾(â‹ˆâŸœÂ¯1â€¿0Â¨(m-1)âŠ¸âˆ¾Â¨â†•m)âˆ¾(â‹ˆâŸœ0â€¿1Â¨âˆ¾âŸœ0Â¨â†•n)âˆ¾(â‹ˆâŸœÂ¯1â€¿0Â¨âˆ¾âŸœ(n-1)Â¨â†•n)
â€¢Show âŒˆÂ´â‰ Â¨â·Â¨âŠ‘Â¨Â¨SimÂ¨starts

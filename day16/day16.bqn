gridâ†>â€¢FLines"input"

âŸ¨PBMâŸ©â†â€¢Import"../../bqn-graphics/pnm.bqn"
Matâ†{1Ë™Â¨âŒ¾(ğ•©âŠ¸âŠ‘)(â‰¢grid)â¥Š0}

Simâ†{
  Stepâ†{ğ•¨ğ•Šiâ€¿vâ€¿nv:
    {ğ•Š1: ("img/out"âˆ¾(1â†“â€¢Fmt 1e4+i)âˆ¾".pnm")â€¢file.Chars PBM Â¬Mat â·âŠ‘Â¨v ; 0}ğ•¨
    nextsâ†{âˆ§Â´(0âŠ¸â‰¤âˆ§<âŸœ(â‰¢grid))âŠ‘ğ•©}Â¨âŠ¸/âˆ¾{ğ•Špâ€¿d:
      {
	ğ•Š'.'â€¿Â·: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'/'â€¿Â·: âŸ¨âŸ¨p-âŒ½d,-âŒ½dâŸ©âŸ© ;
	ğ•Š'\'â€¿Â·: âŸ¨âŸ¨p+âŒ½d,âŒ½dâŸ©âŸ© ;
	ğ•Š'|'â€¿1: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'|'â€¿0: âŸ¨âŸ¨p+1â€¿0,1â€¿0âŸ©,âŸ¨p-1â€¿0,-1â€¿0âŸ©âŸ© ;
	ğ•Š'-'â€¿0: âŸ¨âŸ¨p+d,dâŸ©âŸ© ;
	ğ•Š'-'â€¿1: âŸ¨âŸ¨p+0â€¿1,0â€¿1âŸ©,âŸ¨p-0â€¿1,-0â€¿1âŸ©âŸ©
      }âŸ¨pâŠ‘grid,|âŠ‘dâŸ©
    }Â¨nv
    âŸ¨i+1,nvâˆ¾v,(Â¬nextsâˆŠv)/nextsâŸ©
  }
  â·âŠ‘Â¨1âŠ‘ğ•¨Stepâ€¢_while_{0â‰ â‰ 2âŠ‘ğ•©} 0â€¿âŸ¨âŸ©â€¿âŸ¨ğ•©âŸ©
}

â€¢Show â‰  1 SimâŸ¨0â€¿0,0â€¿1âŸ©

mâ€¿nâ†â‰¢grid
startsâ†(â‹ˆâŸœ1â€¿0Â¨0âŠ¸âˆ¾Â¨â†•m)âˆ¾(â‹ˆâŸœÂ¯1â€¿0Â¨(m-1)âŠ¸âˆ¾Â¨â†•m)âˆ¾(â‹ˆâŸœ0â€¿1Â¨âˆ¾âŸœ0Â¨â†•n)âˆ¾(â‹ˆâŸœÂ¯1â€¿0Â¨âˆ¾âŸœ(n-1)Â¨â†•n)
â€¢Show âŒˆÂ´â‰ Â¨SimÂ¨starts
